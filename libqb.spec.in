%global alphatag @alphatag@
%global numcomm @numcomm@
%global dirty @dirty@

Name:           libqb
Version:        @version@
Release:        1%{?numcomm:.%{numcomm}}%{?alphatag:.%{alphatag}}%{?dirty:.%{dirty}}%{?dist}
Summary:        An IPC library for high performance servers.

Group:          System Environment/Libraries
License:        LGPLv2+
URL:            http://www.libqb.org
Source0:        https://fedorahosted.org/releases/q/u/quarterback/%{name}-%{version}%{?numcomm:.%{numcomm}}%{?alphatag:-%{alphatag}}%{?dirty:-%{dirty}}.tar.gz
BuildRoot:      %(mktemp -ud %{_tmppath}/%{name}-%{version}-%{release}-XXXXXX)

BuildRequires:  autoconf automake libtool doxygen procps check-devel

%description
libqb provides high performance client server reusable features.
Initially these are IPC and poll.

%package        devel
Summary:        Development files for %{name}
Group:          Development/Libraries
Requires:       %{name} = %{version}-%{release} pkgconfig

%description    devel
The %{name}-devel package contains libraries and header files for
developing applications that use %{name}.


%prep
%setup -q -n %{name}-%{version}%{?numcomm:.%{numcomm}}%{?alphatag:-%{alphatag}}%{?dirty:-%{dirty}}


%build
./autogen.sh
%configure --disable-static
make %{?_smp_mflags}

%check
make check

%install
rm -rf $RPM_BUILD_ROOT
make install DESTDIR=$RPM_BUILD_ROOT
find $RPM_BUILD_ROOT -name '*.la' -exec rm -f {} ';'
rm -rf $RPM_BUILD_ROOT/%{_docdir}/*

%clean
rm -rf $RPM_BUILD_ROOT

%post -p /sbin/ldconfig

%postun -p /sbin/ldconfig

%files
%defattr(-,root,root,-)
%doc COPYING
%{_libdir}/libqb.so.*

%files devel
%defattr(-,root,root,-)
%doc COPYING README
%dir %{_includedir}/qb/
%{_libdir}/libqb.so
%{_libdir}/pkgconfig/libqb.pc
%{_includedir}/qb/qbloop.h
%{_includedir}/qb/qbhdb.h
%{_includedir}/qb/qblist.h
%{_includedir}/qb/qbipcc.h
%{_includedir}/qb/qbipcs.h
%{_includedir}/qb/qbipc_common.h
%{_includedir}/qb/qbrb.h
%{_includedir}/qb/qbutil.h
%{_includedir}/qb/qbdefs.h
%{_includedir}/qb/qbatomic.h
%{_includedir}/qb/qbarray.h
%{_mandir}/man3/qb*3*


%changelog
* @date@ Autotools generated version <nobody@nowhere.org> - @version@-1-@numcomm@.@alphatag@.@dirty@
- Autotools generated version
