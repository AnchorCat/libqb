%global alphatag @alphatag@

Name: libqb
Summary: The Quarterback Client Server Developer Library
Version: @version@
Release: 1%{?alphatag:.%{alphatag}}%{?dist}
License: LGPL-2.1
Group: System Environment/Libraries
URL: http://www.libqb.org
Source0: https://fedorahosted.org/releases/q/u/quarterback/%{name}-%{version}.tar.gz

BuildRequires: autoconf automake

BuildRoot: %(mktemp -ud %{_tmppath}/%{name}-%{version}-%{release}-XXXXXX)

%prep
%setup -q -n %{name}-%{version}

./autogen.sh

%{configure}

%build
make %{_smp_mflags}

%install
rm -rf %{buildroot}

make install DESTDIR=%{buildroot}

## tree fixup
# drop static libs
rm -f %{buildroot}%{_libdir}/*.a
# drop docs and html docs for now
rm -rf %{buildroot}%{_docdir}/*

%clean
rm -rf %{buildroot}

%description
This package contains libqb libraries.

%files -n libqb
%defattr(-,root,root,-)
%doc COPYING
%{_libdir}/libqb.so.*

%post -n libqb -p /sbin/ldconfig

%postun -n libqb -p /sbin/ldconfig

%package -n libqb-devel
Summary: The Quarterback Development Kit
Group: Development/Libraries
Requires: libqb = %{version}-%{release}
Requires: pkgconfig
Provides: libqb-devel = %{version}

%description -n libqb-devel
This package contains include files and man pages used to develop using
The Quarterback APIs.

%files -n libqb-devel
%defattr(-,root,root,-)
%doc COPYING README
%dir %{_includedir}/qb/
%{_libdir}/libqb.so
%{_libdir}/libqb.la
%{_libdir}/pkgconfig/libqb.pc
%{_includedir}/qb/qbloop.h
%{_includedir}/qb/qbhdb.h
%{_includedir}/qb/qblist.h
%{_includedir}/qb/qbipcc.h
%{_includedir}/qb/qbipcs.h
%{_includedir}/qb/qbipc_common.h
%{_includedir}/qb/qbrb.h
%{_includedir}/qb/qbutil.h
%{_includedir}/qb/qbdefs.h
%{_includedir}/qb/qbatomic.h
%{_mandir}/man3/qb*3*

%changelog
* @date@ Autotools generated version <nobody@nowhere.org> - @version@-1.@alphatag@
- Autotools generated version
